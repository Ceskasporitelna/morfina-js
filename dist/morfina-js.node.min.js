require("source-map-support").install();
module.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(1))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(5),u=r(6),a=r(9),s=r(11),c=function(){function t(t,e){var r=this;this.precompute=function(t){return Promise.resolve(r.computer.precompute(t))},this.add=function(t,e){return Promise.resolve(r.computer.add(t,e))},this.multiply=function(t,e){return Promise.resolve(r.computer.multiply(t,e))},this.decryptValue=function(t,e){return Promise.resolve(r.decryptor.decryptValue(t,e))},this.config=t,this.credentials=e,this.apiClient=new a.default(t);var s=new n.PrivateKey(new i.BigInteger(e.PAILLIER.publicKey.n),new i.BigInteger(e.PAILLIER.publicKey.g),new i.BigInteger(e.PAILLIER.privateKey.lambda),new i.BigInteger(e.PAILLIER.privateKey.preCalculatedDenominator),new i.BigInteger(e.PAILLIER.publicKey.nSquared)),c=new n.PublicKey(new i.BigInteger(e.PAILLIER.publicKey.n),new i.BigInteger(e.PAILLIER.publicKey.g),new i.BigInteger(e.PAILLIER.publicKey.nSquared));this.computer=new o.default(c,s),this.decryptor=new u.default(this.credentials,c,s)}return t.prototype.morph=function(t){var e=this,r={encryptionParameters:t.encryptionParameters.map(function(t){return t.webAPIKey=e.config.webApiKey,t}),dataArray:t.dataArray};return this.apiClient.encryptData(r)},t.prototype.decryptData=function(t){return Promise.resolve(this.decryptor.decryptData(t))},t.prototype.getDecryptedValuesForPath=function(t,e){return Promise.resolve(this.decryptor.getDecryptedValuesForPath(t,e))},t.getClient=function(e){var r=new a.default(e);if(!e)throw Error("You have to pass credentials to MorfinaClient");return r.getCryptoConfiguration().then(function(n){return s.isObjectEmpty(n.data)?r.createCryptoConfiguration().then(function(n){return r=void 0,new t(e,n.data)}):(r=void 0,new t(e,n.data))})},t}();e.MorfinaClient=c},function(t,e,r){function n(t){return function(){return this.pub[t].apply(this.pub,Array.prototype.slice.apply(arguments))}}var i=r(3).BigInteger,o=r(4),u=new o,a=(i.valueOf(2),{generate:function(t){var e,r;do e=new i(t,1,u),r=new i(t,1,u);while(e.equals(r));var n=e.multiply(r),o=e.subtract(i.ONE),s=r.subtract(i.ONE),c=n.multiply(n),p=o.multiply(s).divide(o.gcd(s)),h=n.bitLength()-Math.floor(10*Math.random()),y=new i(h,1,u),l=new i(h,1,u),d=y.multiply(n).add(i.ONE).multiply(l.modPow(n,c)).mod(c),f=d.modPow(p,c).mod(c).subtract(i.ONE).divide(n).modInverse(n);return new a.PrivateKey(n,d,p,f,c)}});a.PublicKey=function(t,e,r){this.n=t,this.g=e,this.nSq=r||t.multiply(t),this.rncache=[]},a.PublicKey.prototype.encrypt=function(t,e){if(!e){var r;r=this.rncache.length>0?this.rncache.pop():this.getRandomNumber(),e=r}return this.g.modPow(t,this.nSq).multiply(e.modPow(this.n,this.nSq)).mod(this.nSq)},a.PublicKey.prototype.add=function(t,e){return t.multiply(this.encrypt(e)).mod(this.nSq)},a.PublicKey.prototype.addCrypt=function(t,e){return t.multiply(e).mod(this.nSq)},a.PublicKey.prototype.multiply=function(t,e){return t.modPow(e,this.nSq)},a.PublicKey.prototype.precompute=function(t){for(var e=0;e<t;e++)this.rncache.push(this.getRandomNumber())},a.PublicKey.prototype.getRandomNumber=function(){var t=this.n.bitLength()-Math.floor(10*Math.random());return new i(t,1,u)},a.PublicKey.prototype.rerandomize=function(t,e){if(!e){var r;r=this.rncache.length>0?this.rncache.pop():this.getRandomNumber(),e=r}return t.multiply(e.modPow(this.n,this.nSq)).mod(this.nSq)},a.PrivateKey=function(t,e,r,n,i){this.l=r,this.m=n,this.n=t,this.nSq=i||t.multiply(t),this.pub=new a.PublicKey(t,e,this.nSq)},a.PrivateKey.prototype.decrypt=function(t){return t.modPow(this.l,this.nSq).subtract(i.ONE).divide(this.n).multiply(this.m).mod(this.n)},a.PrivateKey.prototype.decryptR=function(t,e){e||(e=this.decrypt(t));var r=t.multiply(this.pub.g.modPow(e,this.nSq).modInverse(this.nSq)).mod(this.nSq),n=this.l.modInverse(this.n).multiply(this.n.subtract(i.ONE)),o=n.multiply(this.l).add(i.ONE).divide(this.n);return r.modPow(o,this.n)};for(var s=["add","addCrypt","multiply","rerandomize","encrypt"],c=0,p=s.length;c<p;c++)a.PrivateKey.prototype[s[c]]=n(s[c]);t.exports=a},function(t,e){t.exports=require("jsbn")},function(t,e){function r(){this.i=0,this.j=0,this.S=new Array}function n(t){var e,r,n;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function i(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function o(){return new r}function u(t){y[l++]^=255&t,y[l++]^=t>>8&255,y[l++]^=t>>16&255,y[l++]^=t>>24&255,l>=d&&(l-=d)}function a(){u((new Date).getTime())}function s(){if(null==h){for(a(),h=o(),h.init(y),l=0;l<y.length;++l)y[l]=0;l=0}return h.next()}function c(t){var e;for(e=0;e<t.length;++e)t[e]=s()}function p(){}r.prototype.init=n,r.prototype.next=i;var h,y,l,d=256,f={},m={};if(null==y){y=new Array,l=0;var g;if(f&&f.crypto&&f.crypto.getRandomValues){var v=new Uint8Array(32);for(f.crypto.getRandomValues(v),g=0;g<32;++g)y[l++]=v[g]}if("Netscape"==m.appName&&m.appVersion<"5"&&f.crypto){var P=f.crypto.random(32);for(g=0;g<P.length;++g)y[l++]=255&P.charCodeAt(g)}for(;l<d;)g=Math.floor(65536*Math.random()),y[l++]=g>>>8,y[l++]=255&g;l=0,a()}p.prototype.nextBytes=c,t.exports=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),i=function(){function t(t,e){var r=this;this.precompute=function(t){return r.publicKey.precompute(t)},this.add=function(t,e){return r.publicKey.addCrypt(r.getEncryptedBigIntegerFromValue(t),r.getEncryptedBigIntegerFromValue(e)).toString()},this.multiply=function(t,e){return r.publicKey.multiply(r.getEncryptedBigIntegerFromValue(t),new n.BigInteger(e.toString(),10)).toString()},this.getEncryptedBigIntegerFromValue=function(t){if("string"==typeof t)return new n.BigInteger(t,10);if("number"==typeof t){var e=new n.BigInteger(t.toString(),10);return r.publicKey.encrypt(e)}throw Error("Input must be number or string")},this.publicKey=t,this.privateKey=e}return t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(7),i=r(8),o=r(3),u=function(){function t(t,e,r){var n=this;this.decryptValue=function(t,e){var r=n.decryptVal(t,e);return r},this.decryptVal=function(t,e){switch(e){case"AES":return i.AES.decrypt(t,i.enc.Base64.parse(n.credentials.AES.key),{mode:i.mode.ECB}).toString(i.enc.Utf8);case"PAILLIER":return n.privateKey.decrypt(new o.BigInteger(t.toString())).toString(10);default:return t}},this.addAsteriskToArrayInPath=function(t){return t.replace("[]","[*]")},this.credentials=t,this.publicKey=e,this.privateKey=r}return t.prototype.decryptData=function(t){var e=this,r=JSON.parse(JSON.stringify(t.dataArray));return t.encryptionParameters.forEach(function(t){n.apply(r,e.addAsteriskToArrayInPath(t.jsonPath),function(r){return e.decryptVal(r,t.encryptionType)})}),r},t.prototype.getDecryptedValuesForPath=function(t,e){var r=this;if(!e)throw Error("You have to provide encryptionParameters as second argument");var i=JSON.parse(JSON.stringify(t)),o=n.query(i,this.addAsteriskToArrayInPath(e.jsonPath)).map(function(t){return r.decryptVal(t,e.encryptionType)});return o},t}();e.default=u},function(t,e){t.exports=require("jsonpath")},function(t,e){t.exports=require("crypto-js")},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=r(10),o=function(){function t(e){var r=this;this.createCryptoConfiguration=function(){return i.post(r.config.baseUrl+"/morfina/api/v1/configuration/"+r.config.webApiKey+"/create",null,{headers:t.headers})},this.getCryptoConfiguration=function(){return i.get(r.config.baseUrl+"/morfina/api/v1/configuration/"+r.config.webApiKey,{headers:t.headers})},this.config=e}return t.prototype.encryptData=function(e){return i.post(this.config.baseUrl+"/morfina/api/v1/encrypt",e,{headers:t.headers})},t.headers={},t}();e.ApiClient=o;var u=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e}(o);e.default=u},function(t,e){t.exports=require("axios")},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return 0===Object.keys(t).length&&t.constructor===Object};e.isObjectEmpty=r}]);
//# sourceMappingURL=morfina-js.node.min.js.map