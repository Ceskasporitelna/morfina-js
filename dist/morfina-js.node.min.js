require("source-map-support").install();
module.exports=function(t){function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}var e={};return i.m=t,i.c=e,i.p="",i(0)}([function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e(1);i.num=3,console.log("paillier",n)},function(t,i,e){function n(t,i){return t.multiply(i).divide(t.gcd(i))}var r=e(2).BigInteger,o=e(3);paillier={publicKey:function(t,i){this.bits=t,this.n=i,this.n2=i.square(),this.np1=i.add(r.ONE),this.rncache=new Array},privateKey:function(t,i){this.lambda=t,this.pubkey=i,this.x=i.np1.modPow(this.lambda,i.n2).subtract(r.ONE).divide(i.n).modInverse(i.n)},generateKeys:function(t){var i,e,s,a={},h=new o;do{do i=new r(t>>1,1,h);while(!i.isProbablePrime(10));do e=new r(t>>1,1,h);while(!e.isProbablePrime(10));s=i.multiply(e)}while(!s.testBit(t-1)||0==i.compareTo(e));return a.pub=new paillier.publicKey(t,s),lambda=n(i.subtract(r.ONE),e.subtract(r.ONE)),a.sec=new paillier.privateKey(lambda,a.pub),a}},paillier.publicKey.prototype={encrypt:function(t){return this.randomize(this.n.multiply(t).add(r.ONE).mod(this.n2))},add:function(t,i){return t.multiply(i).remainder(this.n2)},mult:function(t,i){return t.modPow(i,this.n2)},randomize:function(t){var i;return i=this.rncache.length>0?this.rncache.pop():this.getRN(),t.multiply(i).mod(this.n2)},getRN:function(){var t,i=new o;do t=new r(this.bits,i);while(t.compareTo(this.n)>=0);return t.modPow(this.n,this.n2)},precompute:function(t){for(var i=0;i<t;i++)this.rncache.push(this.getRN())}},paillier.privateKey.prototype={decrypt:function(t){return t.modPow(this.lambda,this.pubkey.n2).subtract(r.ONE).divide(this.pubkey.n).multiply(this.x).mod(this.pubkey.n)}},t.exports=paillier},function(t,i){t.exports=require("jsbn")},function(t,i){function e(){this.i=0,this.j=0,this.S=new Array}function n(t){var i,e,n;for(i=0;i<256;++i)this.S[i]=i;for(e=0,i=0;i<256;++i)e=e+this.S[i]+t[i%t.length]&255,n=this.S[i],this.S[i]=this.S[e],this.S[e]=n;this.i=0,this.j=0}function r(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function o(){return new e}function s(t){c[d++]^=255&t,c[d++]^=t>>8&255,c[d++]^=t>>16&255,c[d++]^=t>>24&255,d>=f&&(d-=f)}function a(){s((new Date).getTime())}function h(){if(null==l){for(a(),l=o(),l.init(c),d=0;d<c.length;++d)c[d]=0;d=0}return l.next()}function u(t){var i;for(i=0;i<t.length;++i)t[i]=h()}function p(){}e.prototype.init=n,e.prototype.next=r;var l,c,d,f=256,m={},y={};if(null==c){c=new Array,d=0;var b;if(m&&m.crypto&&m.crypto.getRandomValues){var v=new Uint8Array(32);for(m.crypto.getRandomValues(v),b=0;b<32;++b)c[d++]=v[b]}if("Netscape"==y.appName&&y.appVersion<"5"&&m.crypto){var w=m.crypto.random(32);for(b=0;b<w.length;++b)c[d++]=255&w.charCodeAt(b)}for(;d<f;)b=Math.floor(65536*Math.random()),c[d++]=b>>>8,c[d++]=255&b;d=0,a()}p.prototype.nextBytes=u,t.exports=p}]);
//# sourceMappingURL=morfina-js.node.min.js.map