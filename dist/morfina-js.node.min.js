require("source-map-support").install();
module.exports=function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.default=n.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(5),a=r(6),u=r(9),s=r(11),c=function(){function t(t,e){var r=this;this.precompute=function(t){return r.computer.precompute(t)},this.add=function(t,e){return r.computer.add(t,e)},this.multiply=function(t,e){return r.computer.multiply(t,e)},this.decryptValue=function(t,e){return r.decryptor.decryptValue(t,e)},this.config=t,this.credentials=e,this.apiClient=new u.default(t);var s=new n.publicKey(e.PAILLIER.publicKey.bits,new i.BigInteger(e.PAILLIER.publicKey.n)),c=new n.privateKey(new i.BigInteger(e.PAILLIER.privateKey.lambda),s);this.computer=new o.default(s,c),this.decryptor=new a.default(this.credentials,s,c)}return t.prototype.morph=function(t){var e=this,r={encryptionParameters:t.encryptionParameters.map(function(t){return t.webAPIKey=e.config.webApiKey,t}),dataArray:t.dataArray};return this.apiClient.encryptData(r)},t.prototype.decryptData=function(t){return this.decryptor.decryptData(t)},t.prototype.getDecryptedValuesForPath=function(t,e){return this.decryptor.getDecryptedValuesForPath(t,e)},t.getClient=function(e){var r=new u.default(e);if(!e)throw Error("You have to pass credentials to MorfinaClient");return r.getCryptoConfiguration().then(function(n){return s.isObjectEmpty(n.data)?r.createCryptoConfiguration().then(function(n){return r=void 0,new t(e,n.data)}):(r=void 0,new t(e,n.data))})},t}();e.default=c},function(t,e,r){function n(t,e){return t.multiply(e).divide(t.gcd(e))}var i=r(3).BigInteger,o=r(4);paillier={publicKey:function(t,e){this.bits=t,this.n=e,this.n2=e.square(),this.np1=e.add(i.ONE),this.rncache=new Array},privateKey:function(t,e){this.lambda=t,this.pubkey=e,this.x=e.np1.modPow(this.lambda,e.n2).subtract(i.ONE).divide(e.n).modInverse(e.n)},generateKeys:function(t){var e,r,a,u={},s=new o;do{do e=new i(t>>1,1,s);while(!e.isProbablePrime(10));do r=new i(t>>1,1,s);while(!r.isProbablePrime(10));a=e.multiply(r)}while(!a.testBit(t-1)||0==e.compareTo(r));return u.pub=new paillier.publicKey(t,a),lambda=n(e.subtract(i.ONE),r.subtract(i.ONE)),u.sec=new paillier.privateKey(lambda,u.pub),u}},paillier.publicKey.prototype={encrypt:function(t){return this.randomize(this.n.multiply(t).add(i.ONE).mod(this.n2))},add:function(t,e){return t.multiply(e).remainder(this.n2)},mult:function(t,e){return t.modPow(e,this.n2)},randomize:function(t){var e;return e=this.rncache.length>0?this.rncache.pop():this.getRN(),t.multiply(e).mod(this.n2)},getRN:function(){var t,e=new o;do t=new i(this.bits,e);while(t.compareTo(this.n)>=0);return t.modPow(this.n,this.n2)},precompute:function(t){for(var e=0;e<t;e++)this.rncache.push(this.getRN())}},paillier.privateKey.prototype={decrypt:function(t){return t.modPow(this.lambda,this.pubkey.n2).subtract(i.ONE).divide(this.pubkey.n).multiply(this.x).mod(this.pubkey.n)}},t.exports=paillier},function(t,e){t.exports=require("jsbn")},function(t,e){function r(){this.i=0,this.j=0,this.S=new Array}function n(t){var e,r,n;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function i(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function o(){return new r}function a(t){f[l++]^=255&t,f[l++]^=t>>8&255,f[l++]^=t>>16&255,f[l++]^=t>>24&255,l>=d&&(l-=d)}function u(){a((new Date).getTime())}function s(){if(null==h){for(u(),h=o(),h.init(f),l=0;l<f.length;++l)f[l]=0;l=0}return h.next()}function c(t){var e;for(e=0;e<t.length;++e)t[e]=s()}function p(){}r.prototype.init=n,r.prototype.next=i;var h,f,l,d=256,y={},g={};if(null==f){f=new Array,l=0;var m;if(y&&y.crypto&&y.crypto.getRandomValues){var v=new Uint8Array(32);for(y.crypto.getRandomValues(v),m=0;m<32;++m)f[l++]=v[m]}if("Netscape"==g.appName&&g.appVersion<"5"&&y.crypto){var b=y.crypto.random(32);for(m=0;m<b.length;++m)f[l++]=255&b.charCodeAt(m)}for(;l<d;)m=Math.floor(65536*Math.random()),f[l++]=m>>>8,f[l++]=255&m;l=0,u()}p.prototype.nextBytes=c,t.exports=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),i=function(){function t(t,e){var r=this;this.precompute=function(t){return Promise.resolve(r.publicKey.precompute(t))},this.add=function(t,e){return r.publicKey.add(r.getEncryptedBigIntegerFromValue(t),r.getEncryptedBigIntegerFromValue(e)).toString()},this.multiply=function(t,e){return r.publicKey.mult(r.getEncryptedBigIntegerFromValue(t),new n.BigInteger(e.toString(),10)).toString()},this.encrypt=function(t){return r.getEncryptedBigIntegerFromValue(t).toString()},this.getEncryptedBigIntegerFromValue=function(t){if("string"==typeof t)return new n.BigInteger(t,10);if("number"==typeof t){var e=new n.BigInteger(t.toString(),10);return r.publicKey.encrypt(e)}throw Error("Input must be number or string")},this.publicKey=t,this.privateKey=e}return t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(7),i=r(8),o=r(3),a=function(){function t(t,e,r){var n=this;this.decryptValue=function(t,e){var r=n.decryptVal(t,e);return Promise.resolve(r)},this.decryptVal=function(t,e){switch(e){case"AES":return i.AES.decrypt(t,i.enc.Base64.parse(n.credentials.AES.key),{mode:i.mode.ECB}).toString(i.enc.Utf8);case"PAILLIER":return n.privateKey.decrypt(new o.BigInteger(t.toString())).toString(10);default:return t}},this.addAsteriskToArrayInPath=function(t){return t.replace("[]","[*]")},this.credentials=t,this.publicKey=e,this.privateKey=r}return t.prototype.decryptData=function(t){var e=this,r=JSON.parse(JSON.stringify(t.dataArray));return t.encryptionParameters.forEach(function(t){n.apply(r,e.addAsteriskToArrayInPath(t.jsonPath),function(r){return e.decryptVal(r,t.encryptionType)})}),Promise.resolve(r)},t.prototype.getDecryptedValuesForPath=function(t,e){var r=this;if(!e)throw Error("You have to provide encryptionParameters as second argument");var i=JSON.parse(JSON.stringify(t)),o=n.query(i,this.addAsteriskToArrayInPath(e.jsonPath)).map(function(t){return r.decryptVal(t,e.encryptionType)});return Promise.resolve(o)},t}();e.default=a},function(t,e){t.exports=require("jsonpath")},function(t,e){t.exports=require("crypto-js")},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=r(10),o=function(){function t(e){var r=this;this.createCryptoConfiguration=function(){return i.post(r.config.baseUrl+"/morfina/api/v1/configuration/"+r.config.webApiKey+"/create",null,{headers:t.headers})},this.getCryptoConfiguration=function(){return i.get(r.config.baseUrl+"/morfina/api/v1/configuration/"+r.config.webApiKey,{headers:t.headers})},this.config=e}return t.prototype.encryptData=function(e){return i.post(this.config.baseUrl+"/morfina/api/v1/encrypt",e,{headers:t.headers})},t.headers={},t}();e.ApiClient=o;var a=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e}(o);e.default=a},function(t,e){t.exports=require("axios")},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return 0===Object.keys(t).length&&t.constructor===Object};e.isObjectEmpty=r}]);
//# sourceMappingURL=morfina-js.node.min.js.map